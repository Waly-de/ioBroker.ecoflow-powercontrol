{
  "type": "tabs",
  "i18n": true,
  "items": {
    "tab_inverters": {
      "type": "tab",
      "label": "tab_inverters",
      "items": {
        "invTableHeader": {
          "type": "staticText",
          "text": "inverters_header"
        },
        "inverters": {
          "type": "table",
          "attr": "inverters",
          "label": "inverters",
          "noDelete": false,
          "noAdd": false,
          "items": [
            {
              "attr": "id",
              "type": "text",
              "title": "col_inv_id",
              "width": "110px"
            },
            {
              "attr": "name",
              "type": "text",
              "title": "col_inv_name",
              "width": "120px"
            },
            {
              "attr": "type",
              "type": "select",
              "title": "col_inv_type",
              "options": [
                { "value": "generic", "label": "Generic" },
                { "value": "ecoflow", "label": "EcoFlow PS" }
              ],
              "width": "120px",
              "default": "generic"
            },
            {
              "attr": "maxPower",
              "type": "number",
              "title": "col_inv_maxpower",
              "width": "80px",
              "default": 800
            },
            {
              "attr": "regulation",
              "type": "checkbox",
              "title": "col_inv_regulation",
              "width": "70px",
              "default": true
            },
            {
              "attr": "hasBat",
              "type": "checkbox",
              "title": "col_inv_hasbat",
              "width": "70px",
              "default": true
            },
            {
              "attr": "outputStateId",
              "type": "text",
              "title": "col_inv_outputstateid",
              "width": "220px"
            },
            {
              "attr": "setOutputStateId",
              "type": "text",
              "title": "col_inv_setoutputstateid",
              "width": "220px"
            },
            {
              "attr": "batterySOCStateId",
              "type": "text",
              "title": "col_inv_batsocstateid",
              "width": "220px"
            },
            {
              "attr": "pvPowerStateId",
              "type": "text",
              "title": "col_inv_pvstateid",
              "width": "220px"
            },
            {
              "attr": "setPriorityStateId",
              "type": "text",
              "title": "col_inv_setpriostateid",
              "width": "220px"
            },
            {
              "attr": "battPozOn",
              "type": "number",
              "title": "col_inv_batpozon",
              "width": "80px",
              "default": 95
            },
            {
              "attr": "battPozOff",
              "type": "number",
              "title": "col_inv_batpozoff",
              "width": "80px",
              "default": 90
            },
            {
              "attr": "battOnSwitchPrio",
              "type": "checkbox",
              "title": "col_inv_switchprio",
              "width": "70px",
              "default": false
            },
            {
              "attr": "prioOffOnDemand",
              "type": "number",
              "title": "col_inv_priooffondemand",
              "width": "80px",
              "default": 0
            },
            {
              "attr": "lowBatLimitPozOn",
              "type": "number",
              "title": "col_inv_lowbatlimitpozon",
              "width": "80px",
              "default": 10
            },
            {
              "attr": "lowBatLimitPozOff",
              "type": "number",
              "title": "col_inv_lowbatlimitpozoff",
              "width": "80px",
              "default": 20
            },
            {
              "attr": "lowBatLimit",
              "type": "number",
              "title": "col_inv_lowbatlimit",
              "width": "80px",
              "default": 100
            },
            {
              "attr": "regulationOffPower",
              "type": "number",
              "title": "col_inv_regulationoffpower",
              "width": "90px",
              "default": 0
            }
          ],
          "columns": [
            {
              "attr": "id",
              "type": "text",
              "title": "col_inv_id",
              "width": "110px"
            },
            {
              "attr": "name",
              "type": "text",
              "title": "col_inv_name",
              "width": "120px"
            },
            {
              "attr": "type",
              "type": "select",
              "title": "col_inv_type",
              "options": [
                { "value": "generic", "label": "Generic" },
                { "value": "ecoflow", "label": "EcoFlow PS" }
              ],
              "width": "120px",
              "default": "generic"
            },
            {
              "attr": "maxPower",
              "type": "number",
              "title": "col_inv_maxpower",
              "width": "80px",
              "default": 800
            },
            {
              "attr": "regulation",
              "type": "checkbox",
              "title": "col_inv_regulation",
              "width": "70px",
              "default": true
            },
            {
              "attr": "hasBat",
              "type": "checkbox",
              "title": "col_inv_hasbat",
              "width": "70px",
              "default": true
            },
            {
              "attr": "outputStateId",
              "type": "text",
              "title": "col_inv_outputstateid",
              "width": "220px"
            },
            {
              "attr": "setOutputStateId",
              "type": "text",
              "title": "col_inv_setoutputstateid",
              "width": "220px"
            },
            {
              "attr": "batterySOCStateId",
              "type": "text",
              "title": "col_inv_batsocstateid",
              "width": "220px"
            },
            {
              "attr": "pvPowerStateId",
              "type": "text",
              "title": "col_inv_pvstateid",
              "width": "220px"
            },
            {
              "attr": "setPriorityStateId",
              "type": "text",
              "title": "col_inv_setpriostateid",
              "width": "220px"
            },
            {
              "attr": "battPozOn",
              "type": "number",
              "title": "col_inv_batpozon",
              "width": "80px",
              "default": 95
            },
            {
              "attr": "battPozOff",
              "type": "number",
              "title": "col_inv_batpozoff",
              "width": "80px",
              "default": 90
            },
            {
              "attr": "battOnSwitchPrio",
              "type": "checkbox",
              "title": "col_inv_switchprio",
              "width": "70px",
              "default": false
            },
            {
              "attr": "prioOffOnDemand",
              "type": "number",
              "title": "col_inv_priooffondemand",
              "width": "80px",
              "default": 0
            },
            {
              "attr": "lowBatLimitPozOn",
              "type": "number",
              "title": "col_inv_lowbatlimitpozon",
              "width": "80px",
              "default": 10
            },
            {
              "attr": "lowBatLimitPozOff",
              "type": "number",
              "title": "col_inv_lowbatlimitpozoff",
              "width": "80px",
              "default": 20
            },
            {
              "attr": "lowBatLimit",
              "type": "number",
              "title": "col_inv_lowbatlimit",
              "width": "80px",
              "default": 100
            },
            {
              "attr": "regulationOffPower",
              "type": "number",
              "title": "col_inv_regulationoffpower",
              "width": "90px",
              "default": 0
            }
          ]
        },
        "addPowerHeader": {
          "type": "staticText",
          "text": "addpower_header"
        },
        "additionalPower": {
          "type": "table",
          "attr": "additionalPower",
          "label": "additionalpower_label",
          "noDelete": false,
          "noAdd": false,
          "items": [
            {
              "attr": "name",
              "type": "text",
              "title": "col_ap_name",
              "width": "150px"
            },
            {
              "attr": "id",
              "type": "text",
              "title": "col_ap_stateid",
              "width": "280px"
            },
            {
              "attr": "factor",
              "type": "number",
              "title": "col_ap_factor",
              "width": "80px",
              "default": 1
            },
            {
              "attr": "offset",
              "type": "number",
              "title": "col_ap_offset",
              "width": "80px",
              "default": 0
            },
            {
              "attr": "noFeedIn",
              "type": "checkbox",
              "title": "col_ap_nofeedin",
              "width": "80px",
              "default": false
            },
            {
              "attr": "noPV",
              "type": "checkbox",
              "title": "col_ap_nopv",
              "width": "70px",
              "default": false
            }
          ],
          "columns": [
            {
              "attr": "name",
              "type": "text",
              "title": "col_ap_name",
              "width": "150px"
            },
            {
              "attr": "id",
              "type": "text",
              "title": "col_ap_stateid",
              "width": "280px"
            },
            {
              "attr": "factor",
              "type": "number",
              "title": "col_ap_factor",
              "width": "80px",
              "default": 1
            },
            {
              "attr": "offset",
              "type": "number",
              "title": "col_ap_offset",
              "width": "80px",
              "default": 0
            },
            {
              "attr": "noFeedIn",
              "type": "checkbox",
              "title": "col_ap_nofeedin",
              "width": "80px",
              "default": false
            },
            {
              "attr": "noPV",
              "type": "checkbox",
              "title": "col_ap_nopv",
              "width": "70px",
              "default": false
            }
          ]
        },
        "ecHeader": {
          "type": "staticText",
          "text": "ec_header"
        },
        "ecEnabled": {
          "type": "checkbox",
          "label": "ec_enabled",
          "attr": "excessCharge.enabled",
          "default": false
        },
        "ecPanel": {
          "type": "panel",
          "label": "ec_panel_label",
          "hidden": "!data.excessCharge.enabled",
          "items": {
            "ecPowerStateId": {
              "type": "text",
              "label": "ec_powerstateid",
              "attr": "excessCharge.powerStateId"
            },
            "ecBatSocStateId": {
              "type": "text",
              "label": "ec_batsocstateid",
              "attr": "excessCharge.batSocStateId"
            },
            "ecActualPowerStateId": {
              "type": "text",
              "label": "ec_actualpowerstateid",
              "attr": "excessCharge.actualPowerStateId"
            },
            "ecSwitchStateId": {
              "type": "text",
              "label": "ec_switchstateid",
              "attr": "excessCharge.switchStateId"
            },
            "ecSwitchOnValue": {
              "type": "text",
              "label": "ec_switchonvalue",
              "attr": "excessCharge.switchOnValue",
              "default": "true"
            },
            "ecSwitchOffValue": {
              "type": "text",
              "label": "ec_switchoffvalue",
              "attr": "excessCharge.switchOffValue",
              "default": "false"
            },
            "ecMaxPower": {
              "type": "number",
              "label": "ec_maxpower",
              "attr": "excessCharge.maxPower",
              "default": 2000
            },
            "ecOffsetPower": {
              "type": "number",
              "label": "ec_offsetpower",
              "attr": "excessCharge.offsetPower",
              "default": 0
            },
            "ecStartPower": {
              "type": "number",
              "label": "ec_startpower",
              "attr": "excessCharge.startPower",
              "default": 50
            },
            "ecStopPower": {
              "type": "number",
              "label": "ec_stoppower",
              "attr": "excessCharge.stopPower",
              "default": 0
            },
            "ecStartDurationMin": {
              "type": "number",
              "label": "ec_startdurationmin",
              "attr": "excessCharge.startDurationMin",
              "default": 1
            },
            "ecMinRegulatePauseMin": {
              "type": "number",
              "label": "ec_minregulatepausemin",
              "attr": "excessCharge.minRegulatePauseMin",
              "default": 1
            },
            "ecRegulateSteps": {
              "type": "number",
              "label": "ec_regulatesteps",
              "attr": "excessCharge.regulateSteps",
              "default": 100
            },
            "ecBatSocMax": {
              "type": "number",
              "label": "ec_batsocmax",
              "attr": "excessCharge.batSocMax",
              "default": 95
            },
            "ecBatSocOff": {
              "type": "number",
              "label": "ec_batsocoff",
              "attr": "excessCharge.batSocOff",
              "default": 100
            },
            "ecSwitchMinMin": {
              "type": "number",
              "label": "ec_switchminmin",
              "attr": "excessCharge.switchMinMin",
              "default": 5
            }
          }
        }
      }
    },
    "tab_ecoflow": {
      "type": "tab",
      "label": "tab_ecoflow",
      "items": {
        "efIntro": {
          "type": "staticText",
          "text": "ecoflow_intro"
        },
        "efEnabled": {
          "type": "checkbox",
          "label": "ecoflow_enabled",
          "attr": "ecoflow.enabled",
          "default": false
        },
        "efCredentialsHeader": {
          "type": "staticText",
          "text": "ecoflow_credentials"
        },
        "efEmail": {
          "type": "text",
          "label": "ecoflow_email",
          "attr": "ecoflow.email"
        },
        "efPassword": {
          "type": "password",
          "label": "ecoflow_password",
          "attr": "ecoflow.password"
        },
        "efReconnectMin": {
          "type": "number",
          "label": "ecoflow_reconnectmin",
          "attr": "ecoflow.reconnectMin",
          "default": 30
        },
        "efTestConnection": {
          "type": "sendTo",
          "label": "ecoflow_test_connection",
          "command": "testEcoflowConnection",
          "jsonData": "{\"email\":\"${data.ecoflow.email}\",\"password\":\"${data.ecoflow.password}\",\"reconnectMin\":\"${data.ecoflow.reconnectMin}\"}",
          "showProcess": true,
          "result": {
            "test_ok": "ecoflow_test_success"
          },
          "error": {
            "test_err": "ecoflow_test_error"
          },
          "variant": "contained",
          "okText": "ecoflow_test_ok"
        },
        "efTestHint": {
          "type": "staticText",
          "text": "ecoflow_test_hint"
        },
        "efImportHeader": {
          "type": "staticText",
          "text": "ecoflow_import_header"
        },
        "efLegacyScriptImport": {
          "type": "text",
          "label": "ecoflow_import_paste",
          "attr": "ecoflow.legacyScriptImport",
          "minRows": 8,
          "maxRows": 20
        },
        "efImportSettings": {
          "type": "sendTo",
          "label": "ecoflow_import_button",
          "command": "importOldScriptSettings",
          "jsonData": "{\"script\":\"${data.ecoflow.legacyScriptImport}\"}",
          "showProcess": true,
          "result": {
            "import_ok": "ecoflow_import_success"
          },
          "error": {
            "import_err": "ecoflow_import_error"
          },
          "variant": "contained",
          "okText": "ecoflow_import_ok"
        },
        "efResetAll": {
          "type": "sendTo",
          "label": "ecoflow_reset_button",
          "command": "resetAllSettings",
          "data": {},
          "showProcess": true,
          "result": {
            "reset_ok": "ecoflow_reset_success"
          },
          "error": {
            "reset_err": "ecoflow_reset_error"
          },
          "useNative": true,
          "variant": "outlined",
          "okText": "ecoflow_reset_ok"
        },
        "efImportHint": {
          "type": "staticText",
          "text": "ecoflow_import_hint"
        },
        "efCommandStatusHeader": {
          "type": "staticText",
          "text": "ecoflow_command_status_header"
        },
        "efLastResult": {
          "type": "state",
          "label": "ecoflow_command_lastresult",
          "foreign": true,
          "oid": "ecoflow-powercontrol.%INSTANCE%.commands.lastResult",
          "control": "text",
          "readOnly": true
        },
        "efDevicesHeader": {
          "type": "staticText",
          "text": "ecoflow_devices_header"
        },
        "efDevices": {
          "type": "table",
          "attr": "ecoflow.devices",
          "label": "ecoflow_devices",
          "noDelete": false,
          "noAdd": false,
          "items": [
            {
              "attr": "serial",
              "type": "text",
              "title": "col_ef_serial",
              "width": "200px",
              "default": "XXXXXXXXXXXXX"
            },
            {
              "attr": "name",
              "type": "text",
              "title": "col_ef_name",
              "width": "150px"
            },
            {
              "attr": "typ",
              "type": "select",
              "title": "col_ef_typ",
              "options": [
                { "value": "PS", "label": "PowerStream (PS)" },
                { "value": "DM", "label": "DELTA Max (DM)" },
                { "value": "D2", "label": "DELTA 2 (D2)" },
                { "value": "D2M", "label": "DELTA 2 Max (D2M)" },
                { "value": "SM", "label": "Smart Plug (SM)" }
              ],
              "width": "180px",
              "default": "PS"
            },
            {
              "attr": "subscribe",
              "type": "checkbox",
              "title": "col_ef_subscribe",
              "width": "90px",
              "default": true
            }
          ],
          "columns": [
            {
              "attr": "serial",
              "type": "text",
              "title": "col_ef_serial",
              "width": "200px",
              "default": "XXXXXXXXXXXXX"
            },
            {
              "attr": "name",
              "type": "text",
              "title": "col_ef_name",
              "width": "150px"
            },
            {
              "attr": "typ",
              "type": "select",
              "title": "col_ef_typ",
              "options": [
                { "value": "PS", "label": "PowerStream (PS)" },
                { "value": "DM", "label": "DELTA Max (DM)" },
                { "value": "D2", "label": "DELTA 2 (D2)" },
                { "value": "D2M", "label": "DELTA 2 Max (D2M)" },
                { "value": "SM", "label": "Smart Plug (SM)" }
              ],
              "width": "180px",
              "default": "PS"
            },
            {
              "attr": "subscribe",
              "type": "checkbox",
              "title": "col_ef_subscribe",
              "width": "90px",
              "default": true
            }
          ]
        },
        "efPathsHint": {
          "type": "staticText",
          "text": "ecoflow_statepaths_hint"
        }
      }
    },
    "tab_regulation": {
      "type": "tab",
      "label": "tab_regulation",
      "items": {
        "regSmHeader": {
          "type": "staticText",
          "text": "reg_sm_header"
        },
        "regSmStateId": {
          "type": "text",
          "label": "reg_smartmeterstateid",
          "attr": "regulation.smartmeterStateId"
        },
        "regSmTimeoutMin": {
          "type": "number",
          "label": "reg_smartmetertimeoutmin",
          "attr": "regulation.smartmeterTimeoutMin",
          "default": 4
        },
        "regSmFallback": {
          "type": "number",
          "label": "reg_smartmeterfallbackpower",
          "attr": "regulation.smartmeterFallbackPower",
          "default": 150
        },
        "regLoopHeader": {
          "type": "staticText",
          "text": "reg_loop_header"
        },
        "regIntervalSec": {
          "type": "number",
          "label": "reg_intervalsec",
          "attr": "regulation.intervalSec",
          "default": 15
        },
        "regBasePowerOffset": {
          "type": "number",
          "label": "reg_basepoweroffset",
          "attr": "regulation.basePowerOffset",
          "default": 30
        },
        "regMinValueMin": {
          "type": "number",
          "label": "reg_minvaluemin",
          "attr": "regulation.minValueMin",
          "default": 2
        },
        "regMinValueAg": {
          "type": "select",
          "label": "reg_minvalueag",
          "attr": "regulation.minValueAg",
          "options": [
            { "value": 0, "label": "reg_minvalueag_min" },
            { "value": 1, "label": "reg_minvalueag_avg" }
          ],
          "default": 0
        },
        "regZusatzpowerOffset": {
          "type": "number",
          "label": "reg_zusatzpoweroffset",
          "attr": "regulation.zusatzpowerOffset",
          "default": 10
        },
        "regMultiHeader": {
          "type": "staticText",
          "text": "reg_multiinv_header"
        },
        "regMultiPsMode": {
          "type": "select",
          "label": "reg_multipsmode",
          "attr": "regulation.multiPsMode",
          "options": [
            { "value": 0, "label": "reg_multipsmode_balance" },
            { "value": 1, "label": "reg_multipsmode_serial" }
          ],
          "default": 0
        },
        "regSerialReverse": {
          "type": "checkbox",
          "label": "reg_serialreverse",
          "attr": "regulation.serialReverse",
          "default": false,
          "hidden": "data.regulation.multiPsMode != 1"
        },
        "regHistoryHeader": {
          "type": "staticText",
          "text": "reg_history_header"
        },
        "regHistoryAdapter": {
          "type": "select",
          "label": "reg_historyadapter",
          "attr": "regulation.historyAdapter",
          "options": [
            { "value": "history",  "label": "ioBroker History" },
            { "value": "influxdb", "label": "InfluxDB" },
            { "value": "sql",      "label": "SQL" }
          ],
          "default": "history"
        },
        "regHistoryInstance": {
          "type": "text",
          "label": "reg_historyinstance",
          "attr": "regulation.historyInstance",
          "default": "0"
        }
      }
    },
    "tab_info": {
      "type": "tab",
      "label": "tab_info",
      "items": {
        "dbgHeader": {
          "type": "staticText",
          "text": "debug_header"
        },
        "advDebug": {
          "type": "checkbox",
          "label": "advanced_debug",
          "attr": "advanced.debug",
          "default": false
        },
        "advMlog": {
          "type": "checkbox",
          "label": "advanced_mlog",
          "attr": "advanced.mlog",
          "default": false
        },
        "advAvgPeriodMs": {
          "type": "number",
          "label": "advanced_avgperiodms",
          "attr": "advanced.avgPeriodMs",
          "default": 15000
        },
        "infoLinks": {
          "type": "staticText",
          "text": "info_links"
        },
        "infoOffPowerHint": {
          "type": "staticText",
          "text": "info_regulationoffpower_hint"
        }
      }
    }
  }
}
